import _ from"lodash";import{getNewsData}from"./service.js";const newsContainer=document.querySelector("[data-news-container]"),buttonMore=document.querySelector("[data-load-more]");let count=10;function convertiDate(e){return new Date(1e3*e).toLocaleString("it-IT",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"})}function creaLinkNews(e,t){t.textContent="Leggi notizia";const n=_.get(e,"url","#");"#"!==n&&n?(t.href=n,t.setAttribute("target","_blank"),t.setAttribute("rel","noopener noreferrer")):(t.style.pointerEvents="none",t.style.color="#ccc")}function newsFinite(){let e=document.createElement("article"),t=document.createElement("div");t.className="news-container",newsContainer.appendChild(e),e.appendChild(t);let n=document.createElement("h2");t.appendChild(n),n.textContent="Hai visualizzato tutte le notizie. Torna pi√π tardi!",buttonMore.style.display="none"}function creaNews(e){let t=document.createElement("article"),n=document.createElement("div"),o=document.createElement("h3"),a=document.createElement("a"),i=document.createElement("p");n.className="news-container",newsContainer.appendChild(t),t.appendChild(n),n.appendChild(o),n.appendChild(a),n.appendChild(i),o.textContent=_.get(e,"title","Titolo non disponibile"),creaLinkNews(e,a),i.textContent=convertiDate(_.get(e,"time",0))}async function loadNews(e){for(let t=0;t<10;t++){creaNews(await getNewsData(e[t])||{title:"Errore nel caricamento della notizia."})}buttonMore.addEventListener("click",(async()=>{if(!buttonMore.disabled){buttonMore.disabled=!0,buttonMore.textContent="Caricamento...";for(let t=count;t<count+10;t++){const n=await getNewsData(e[t]);if(!n){newsFinite();break}creaNews(n)}count+=10,buttonMore.disabled=!1,buttonMore.textContent="Carica altre notizie"}}))}export{loadNews};